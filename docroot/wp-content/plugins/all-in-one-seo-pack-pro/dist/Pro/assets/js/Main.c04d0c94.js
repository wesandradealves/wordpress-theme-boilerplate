import{u as k,d as O,D as B,p as N,a as V}from"./links.4ebb20e1.js";import I from"./BadBotBlocker.ae588ea9.js";import{C as U}from"./Index.276c06e8.js";import E from"./DatabaseTools.2192e8a3.js";import{C as R}from"./index.63c9ec9d.js";import{C as Y}from"./Card.fb1280a3.js";import{C as H}from"./Tabs.1abedd25.js";import{C as K}from"./Index.7805c951.js";import{C as z}from"./NetworkSiteSelector.4c99c0f2.js";import{C as P}from"./SettingsRow.7db26b8a.js";import{B as F}from"./Checkbox.349747c9.js";import{G,a as W}from"./Row.eead99c7.js";import{r as l,o as n,c as h,g,w as u,F as T,D as M,d as p,C as A,y as m,a as c,b as w,B as C,f as q}from"./vue.runtime.esm-bundler.a2ae84e1.js";import{_ as v}from"./_plugin-vue_export-helper.d7c6d548.js";import{S as j}from"./Caret.833cbb47.js";import J from"./HtaccessEditor.5ed942df.js";import Q from"./ImportExport.a3fafeb0.js";import X from"./RobotsEditor.956e7677.js";import Z from"./SystemStatus.d23f831c.js";import ee from"./WpCode.1731b674.js";import"./default-i18n.cb62c1e5.js";import"./isArrayLikeObject.86aee886.js";import"./Textarea.e4bb74d5.js";import"./Tooltip.f932ed03.js";import"./Slide.b264e916.js";/* empty css                                            */import"./license.f68289d9.js";import"./upperFirst.feef3474.js";import"./_stringToArray.4de3b1f3.js";import"./toString.0b0abfad.js";import"./allowed.e7d024f1.js";import"./deburr.a5d10bf3.js";/* empty css             */import"./params.f0608262.js";/* empty css                                              */import"./constants.3cff9bad.js";import"./Ellipse.af318a8d.js";/* empty css                                              */import"./Header.55843ed4.js";import"./addons.ece7eb50.js";import"./ScrollAndHighlight.e31477b3.js";import"./LicenseKeyBar.0de9e929.js";import"./LogoGear.486c3049.js";import"./AnimatedNumber.a6ac6a53.js";import"./numbers.18b50505.js";import"./Logo.13a17fb4.js";import"./Support.853cfed5.js";import"./Date.0365e7f7.js";import"./Exclamation.b5609fd8.js";import"./Url.48ac7d42.js";import"./Gear.4a41a4ff.js";import"./Network.8f632a26.js";import"./ToolsSettings.3b91081b.js";import"./Checkmark.f214118b.js";import"./Index.a392ec8a.js";import"./Blur.718f6c18.js";import"./TruSeoScore.5da2419b.js";import"./Information.4f2d4b14.js";import"./Editor.e50d1a83.js";import"./tags.e7f6eb6d.js";import"./Plus.cf4682aa.js";import"./History.9a15ab15.js";import"./Refresh.6c1a0eff.js";import"./Upload.020413fd.js";import"./Download.1267020b.js";import"./Drag.fce9e4e6.js";import"./vue.runtime.esm-bundler.bf3ec94d.js";import"./External.a8a08ac9.js";import"./Row.e78ba300.js";const te={setup(){return{rootStore:k()}},emits:["update"],components:{BaseCheckbox:F,GridColumn:G,GridRow:W},props:{loading:Boolean,disabled:Boolean},data(){return{options:{},strings:{updateOptions:this.$t.__("Update Options",this.$td)}}},mounted(){this.rootStore.aioseo.deprecatedOptions.forEach(e=>{e.enabled&&(this.options[e.value]=!0)})}},oe={class:"aioseo-deprecated-options"},se=c("br",null,null,-1),ie=c("br",null,null,-1),ne=c("br",null,null,-1);function re(e,o,s,r,t,a){const d=l("base-checkbox"),f=l("grid-column"),S=l("grid-row"),b=l("base-button");return n(),h("div",oe,[g(S,{class:"settings"},{default:u(()=>[(n(!0),h(T,null,M(r.rootStore.aioseo.deprecatedOptions,(_,y)=>(n(),p(f,{key:y,xl:"6",sm:"12"},{default:u(()=>[g(d,{size:"medium",modelValue:t.options[_.value],"onUpdate:modelValue":D=>t.options[_.value]=D,disabled:s.disabled},{default:u(()=>[A(m(_.label),1)]),_:2},1032,["modelValue","onUpdate:modelValue","disabled"])]),_:2},1024))),128))]),_:1}),se,g(b,{type:"blue",size:"medium",onClick:o[0]||(o[0]=_=>e.$emit("update",t.options)),loading:s.loading,disabled:s.disabled},{default:u(()=>[A(m(t.strings.updateOptions),1)]),_:1},8,["loading","disabled"]),ie,ne])}const ae=v(te,[["render",re]]);const le={setup(){return{optionsStore:O()}},computed:{infoItems(){return[{label:"Migrated Version",value:this.optionsStore.internalOptions.internal.migratedVersion},{label:"First Activated",value:this.optionsStore.internalOptions.internal.firstActivated!==0?B.fromMillis(this.optionsStore.internalOptions.internal.firstActivated*1e3).toFormat("MMMM d, yyyy"):!1}]}}},ce={class:"v3-migration-info aioseo-description"},de={class:"info-items"},ue={key:0},pe={key:1};function me(e,o,s,r,t,a){return n(),h("div",ce,[c("ul",de,[(n(!0),h(T,null,M(a.infoItems,(d,f)=>(n(),h("li",{key:f},[d.value?(n(),h("span",ue,m(d.label),1)):w("",!0),d.value?(n(),h("span",pe,m(d.value),1)):w("",!0)]))),128))])])}const he=v(le,[["render",me]]);const ge={setup(){return{rootStore:k(),toolsStore:N()}},components:{CoreAlert:R,CoreCard:Y,CoreMainTabs:H,CoreModal:K,CoreNetworkSiteSelector:z,CoreSettingsRow:P,DeprecatedOptions:ae,MigrationInfo:he,SvgClose:j},props:{extraActions:{type:Array,required:!1}},data(){return{site:{},tabsKey:0,doingActionKey:0,activeTab:"general",currentAction:"",showAreYouSureModal:!1,doingAction:[],strings:{selectSite:"Select Site",cardLabel:"Debug",selectLabel:"Select a Debug Action:",buttonLabel:"Run Action",alertWarning:"Before you run any action, please make sure that you have fully read the description and understand the consequences as these cannot be reverted.",cannotBeUndone:"This action cannot be undone.",yesDoAction:"Yes, run this action",noChangedMind:"No, I changed my mind"},alertLink:this.$links.getPlainLink("Click here to open to the Scheduled Actions panel",this.rootStore.aioseo.urls.admin.scheduledActions,!0)}},computed:{areYouSureTitle(){return`Are you sure you want to run the "${this.currentAction.label}" action?`},tabs(){const e=this.$t.sprintf('<a href="%1$s" target="_blank">Scheduled Actions</a>',this.rootStore.aioseo.urls.admin.scheduledActions),o=this.rootStore.aioseo.data.isNetworkAdmin?"<br><strong>NOTE: If no site is selected, this will clear the network cache.</strong>":"",s=this.rootStore.aioseo.data.isNetworkAdmin?"<br><strong>NOTE: If no site is selected, this will clear the network plugin updates transient.</strong>":"";return[{slug:"general",name:"General",actions:[{label:"Clear Cache",slug:"clear-cache",shortDescription:`This action deletes all records of the <code>aioseo_cache</code> table in the database.${o}`,longDescription:"",showModal:!1,network:!0},{label:"Clear Plugin Updates Transient",slug:"clear-plugin-updates-transient",shortDescription:`This action clears the plugin updates transient, which forces WordPress Core to check for plugin updates.${s}`,longDescription:"",showModal:!1,network:!0},{label:"Readd Capabilities",slug:"readd-capabilities",shortDescription:"This action will readd our capabilities (access permissions) for all users.",longDescription:"",showModal:!1},{label:"Reset Data",slug:"reset-data",shortDescription:"This action will <strong>delete</strong> all our custom tables and options.",longDescription:"",showModal:!0}]},{slug:"sitemap",name:"Sitemap",actions:[{label:"Clear Image Data",slug:"clear-image-data",shortDescription:"This action removes all image data from the database, forcing a site-wide rescan via Action Scheduler.",longDescription:this.$t.sprintf("To speed up the image scan, go to %1$s and run the <code>aioseo_image_sitemap_scan</code> action.",e),showModal:!1}]},{slug:"migrations",name:"Migrations",actions:[{label:"Rerun V4+ Migrations",slug:"rerun-migrations",shortDescription:"This action will rerun all update migrations since 4.0.0, excluding the V3 migration.",longDescription:"",showModal:!0}]},{slug:"old-issues",name:"Old Issues",actions:[{label:"Remove Duplicates",slug:"remove-duplicates",shortDescription:"This action will delete any duplicate records that are found in the <code>aioseo_posts</code> and <code>aioseo_terms</code> tables.",longDescription:"",showModal:!1},{label:"Unescape Data",slug:"unescape-data",shortDescription:"This action will clean <code>aioseo_posts</code> and <code>aioseo_term</code> records whose data is corrupted.",longDescription:this.$t.sprintf("The action will trigger a routine which runs in batches via Action Scheduler. It may take some time for this routine to complete, To speed up this process, go to %1$s and run the <code>aioseo_unslash_escaped_data_posts</code> or <code>aioseo_unslash_escaped_data_terms</code> action.",e),showModal:!1}]},{slug:"deprecated-options",name:"Deprecated Options",actions:[{label:"Deprecated Options",slug:"deprecated-options",shortDescription:"Enable or disable any options that have been deprecated in AIOSEO.",longDescription:"<strong>These options are not guaranteed to work and all support has been dropped.</strong>",showModal:!1,component:"deprecated-options"}]}]},activeTabObject(){return this.tabs.find(e=>e.slug===this.activeTab)}},methods:{isActionDisabled(e){return this.rootStore.aioseo.data.isNetworkAdmin?this.site.blog_id?this.site.blog_id==="network"&&e.network?!1:this.site.blog_id==="network"&&!e.network:!0:!1},isLoading(e){return!!this.doingAction[e.slug]},getSelectedActionObject(e){let o=null;return this.actions.forEach(s=>{const r=s.options.find(t=>t.value===e);r&&(o=r)}),o},maybeDoAction(e,o){if(this.currentAction=e,e.showModal){this.showAreYouSureModal=!0;return}this.doAction(o)},doAction(e){this.doingAction[this.currentAction.slug]=!0,this.showAreYouSureModal=!1,this.doingActionKey++,this.toolsStore.doTask({action:this.currentAction.slug,siteId:this.site.blog_id,data:e}).then(()=>{console.log(`Action "${this.currentAction.label}" has been completed.`)}).catch(o=>{console.error(`Action "${this.currentAction.label}" could not be completed: `,o)}).finally(()=>{this.doingAction[this.currentAction.slug]=!1,this.doingActionKey++})}},beforeMount(){var o;let e=-1;if(this.rootStore.aioseo.data.v3Options&&(e=this.tabs.findIndex(s=>s.slug.toLowerCase()==="migrations"),e!==-1)){const s=this.$t.sprintf('<a href="%1$s" target="_blank">Scheduled Actions</a>',this.rootStore.aioseo.urls.admin.scheduledActions);this.tabs[e].actions.push({label:"Rerun V3 Migration",slug:"restart-v3-migration",shortDescription:"This action restarts the migration from V3 to V4.",longDescription:this.$t.sprintf("All settings will be migrated immediately. However, the post/term meta needs to be migrated via a routine which runs in batches via Action Scheduler. To speed up the post/term meta migration, go to %1$s and run the <code>aioseo_migrate_post_meta</code> or <code>aioseo_migrate_term_meta</code> action.",s),infoComponent:"MigrationInfo",showModal:!0})}(o=this.extraActions)!=null&&o.length&&this.extraActions.forEach(s=>{if(e=this.tabs.findIndex(r=>r.slug.toLowerCase()===s.slug.toLowerCase()),e!==-1){this.tabs[e].actions=this.tabs[e].actions.concat(s.actions);return}this.tabs.push(s)})}},_e={class:"aioseo-tools-debug"},fe={key:0,class:"aioseo-settings-row"},be={class:"select-site"},Ae=["innerHTML"],we=["innerHTML"],ve=["innerHTML"],ke={class:"aioseo-modal-body"},Se=["innerHTML"];function ye(e,o,s,r,t,a){const d=l("core-network-site-selector"),f=l("core-alert"),S=l("core-main-tabs"),b=l("base-button"),_=l("core-settings-row"),y=l("svg-close"),D=l("core-modal"),x=l("core-card");return n(),h("div",_e,[g(x,{slug:"debug","header-text":t.strings.cardLabel},{default:u(()=>[r.rootStore.aioseo.data.isNetworkAdmin?(n(),h("div",fe,[c("div",be,m(t.strings.selectSite),1),g(d,{onSelectedSite:o[0]||(o[0]=i=>t.site=i),"show-network":""})])):w("",!0),g(f,{type:"yellow"},{default:u(()=>[c("div",null,m(t.strings.alertWarning),1),c("div",{innerHTML:t.alertLink},null,8,Ae)]),_:1}),(n(),p(S,{internal:"",key:t.tabsKey,tabs:a.tabs,active:t.activeTab,showSaveButton:!1,onChanged:o[1]||(o[1]=i=>t.activeTab=i)},null,8,["tabs","active"])),(n(!0),h(T,null,M(a.activeTabObject.actions,(i,L)=>(n(),p(_,{key:t.activeTab+L,name:i.label,align:""},{content:u(()=>[i.component?(n(),p(C(i.component),{key:0,onUpdate:$=>a.maybeDoAction(i,$),loading:t.doingAction[i.slug],disabled:a.isActionDisabled(i)},null,40,["onUpdate","loading","disabled"])):(n(),p(b,{type:"blue",size:"medium",onClick:$=>a.maybeDoAction(i),loading:t.doingAction[i.slug],key:t.doingActionKey,disabled:a.isActionDisabled(i)},{default:u(()=>[A(m(t.strings.buttonLabel),1)]),_:2},1032,["onClick","loading","disabled"])),c("div",{class:"aioseo-description",innerHTML:i.shortDescription},null,8,we),c("div",{class:"aioseo-description",innerHTML:i.longDescription},null,8,ve),i.infoComponent?(n(),p(C(i.infoComponent),{key:2})):w("",!0)]),_:2},1032,["name"]))),128)),t.showAreYouSureModal?(n(),p(D,{key:1,"no-header":"",onClose:o[5]||(o[5]=i=>t.showAreYouSureModal=!1)},{body:u(()=>[c("div",ke,[c("button",{class:"close",onClick:o[3]||(o[3]=q(i=>t.showAreYouSureModal=!1,["stop"]))},[g(y,{onClick:o[2]||(o[2]=i=>t.showAreYouSureModal=!1)})]),c("h3",null,m(a.areYouSureTitle),1),c("div",{class:"description",innerHTML:t.strings.cannotBeUndone},null,8,Se),g(b,{type:"blue",size:"medium",onClick:a.doAction},{default:u(()=>[A(m(t.strings.yesDoAction),1)]),_:1},8,["onClick"]),g(b,{type:"gray",size:"medium",onClick:o[4]||(o[4]=i=>t.showAreYouSureModal=!1)},{default:u(()=>[A(m(t.strings.noChangedMind),1)]),_:1})])]),_:1})):w("",!0)]),_:1},8,["header-text"])])}const De=v(ge,[["render",ye]]),Ce={setup(){return{addonsStore:V(),rootStore:k()}},components:{Debug:De},computed:{extraActions(){const e=this.$t.sprintf('<a href="%1$s" target="_blank">Scheduled Actions</a>',this.rootStore.aioseo.urls.admin.scheduledActions),o=this.addonsStore.addons.find(t=>t.sku==="aioseo-video-sitemap"),s=this.addonsStore.addons.find(t=>t.sku==="aioseo-link-assistant"),r=[];return o.isActive&&r.push({slug:"sitemap",actions:[{label:"Clear Video Data",slug:"clear-video-data",shortDescription:"This action removes all video data from the database, forcing a site-wide rescan via Action Scheduler.",longDescription:this.$t.sprintf("To speed up the video scan, go to %1$s and run the <code>aioseo_video_sitemap_scan</code> action.",e),showModal:!1}]}),s.isActive&&r.push({slug:"link-assistant",name:"Link Assistant",actions:[{label:"Clear Data",slug:"link-assistant-clear-data",shortDescription:"This action removes all Link Assistant data from the database, forcing a site-wide rescan via Action Scheduler.",longDescription:this.$t.sprintf("The various Link Assistant scans can be sped up through the %1$s",e),showModal:!0},{label:"Clear Links",slug:"link-assistant-clear-links",shortDescription:"This action removes all link data from the database, forcing a site-wide rescan via Action Scheduler.",longDescription:this.$t.sprintf("To speed up the links scan, go to %1$s and run the <code>aioseo_link_assistant_links_scan</code> action.",e),showModal:!0},{label:"Clear Suggestions",slug:"link-assistant-clear-suggestions",shortDescription:"This action removes all link suggestion data from the database, forcing a site-wide rescan via Action Scheduler.",longDescription:this.$t.sprintf("To speed up the links scan, go to %1$s and run the <code>aioseo_link_assistant_link_suggestions_scan</code> action.",e),showModal:!0},{label:"Undismiss Suggestions",slug:"link-assistant-undismiss-suggestions",shortDescription:"This action removes the dismissed state from all suggestions, which makes them appear in the UI again.",longDescription:this.$t.sprintf("To speed up the video scan, go to %1$s and run the <code>aioseo_video_sitemap_scan</code> action.",e),showModal:!1}]}),r}}};function Te(e,o,s,r,t,a){const d=l("debug",!0);return n(),p(d,{extraActions:a.extraActions},null,8,["extraActions"])}const Me=v(Ce,[["render",Te]]),$e={setup(){return{rootStore:k()}},components:{BadBotBlocker:I,CoreMain:U,DatabaseTools:E,Debug:Me,HtaccessEditor:J,ImportExport:Q,RobotsEditor:X,SystemStatus:Z,WpCode:ee},data(){return{strings:{pageName:this.rootStore.aioseo.data.isNetworkAdmin?this.$t.__("Network Tools",this.$td):this.$t.__("Tools",this.$td)}}},computed:{showSaveButton(){return this.$route.name!=="system-status"&&this.$route.name!=="import-export"&&this.$route.name!=="database-tools"&&this.$route.name!=="debug"&&this.$route.name!=="wp-code"}}};function xe(e,o,s,r,t,a){const d=l("core-main");return n(),p(d,{"page-name":t.strings.pageName,"show-save-button":a.showSaveButton},{default:u(()=>[(n(),p(C(e.$route.name)))]),_:1},8,["page-name","show-save-button"])}const Gt=v($e,[["render",xe]]);export{Gt as default};
